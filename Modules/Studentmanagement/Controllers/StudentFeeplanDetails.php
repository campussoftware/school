<?php/* * To change this license header, choose License Headers in Project Properties. * To change this template file, choose Tools | Templates * and open the template in the editor. *//** * Description of StudentFeeplanDetails * * @author ramesh */namespace Modules\Studentmanagement\Controllers;use Core\Controllers\NodeController;class StudentFeeplanDetails extends NodeController{    public $_feecollection;    public $_studentCollection;    //put your code here        public function getFeeStructureAction()    {        $studentModel = \CoreClass::getModel("student_history");        $studentModel->setStudentId(\Core::getValueFromArray($this->_requestedData, "student_admission_id"));        $studentModel->setAdmissionNo(\Core::getValueFromArray($this->_requestedData, "admision_no"));        $studentModel->setAcademicyear(\Core::getValueFromArray($this->_requestedData, "cur_list_academicyear_id"));        $this->_studentCollection=$studentModel->getStudentDetails();                       $feeModel = \CoreClass::getModel("student_feeplan_details");        $feeModel->setStudentId(\Core::getValueFromArray($this->_requestedData, "student_admission_id"));        $feeModel->setAdmissionNo(\Core::getValueFromArray($this->_requestedData, "admision_no"));        $feeModel->setAcademicyear(\Core::getValueFromArray($this->_requestedData, "cur_list_academicyear_id"));        $this->_feecollection=$feeModel->getStudentFeeDetails();                              if($this->_requestedData['dataType']=='json')        {            echo \Core::convertArrayToJson(array("studnetdata"=>$this->_studentCollection,"feeData"=>$this->_feecollection,"totalData"=>\Core::sumOfArarrayValues($this->_feecollection, array("amount","concession","finalamount","paidamount","balance"))));            die;        }        else        {            if($this->_requestedData['node']=='financeconcession')            {                                $this->loadLayout("feestructureforconcession.phtml");            }            else            {                $this->loadLayout("feestructureforfeereceipt.phtml");            }        }    }    public function getPaymentTypes()    {        $db= new \Core\DataBase\ProcessQuery();        $db->setTable("core_payment_type","pt");                $db->addFieldArray(array("pt.name"=>"pds"));        $db->addFieldArray(array("pt.short_code"=>"pid"));        $db->buildSelect();        $result=$db->getRows();        return $result;    }      public function getConcessionFypes()    {        $db= new \Core\DataBase\ProcessQuery();        $db->setTable("fee_concession_type","ctp");                $db->addFieldArray(array("ctp.name"=>"pds"));        $db->addFieldArray(array("ctp.id"=>"pid"));        $db->buildSelect();        $result=$db->getRows();        return $result;    }      }